"use strict";(self.webpackChunkarch_guide=self.webpackChunkarch_guide||[]).push([[4853],{764:(a,s,n)=>{n.r(s),n.d(s,{comp:()=>t,data:()=>r});var e=n(641);const i=[(0,e.Fv)('<h1 id="minio-集群数据备份如何进行冷备" tabindex="-1"><a class="header-anchor" href="#minio-集群数据备份如何进行冷备"><span>Minio 集群数据备份如何进行冷备？</span></a></h1><p>MinIO 的数据备份和恢复确实可以通过直接复制磁盘存储目录的方式实现，这被称为“冷备”方式。 冷备的原理是将整个 MinIO 数据目录作为文件系统级别的备份，然后在需要时通过复制这些文件来 恢复数据。这种方式适用于对备份速度要求不高的情况，因为它通常需要停止 MinIO 服务以确保数据 一致性。</p><h3 id="冷备的操作步骤" tabindex="-1"><a class="header-anchor" href="#冷备的操作步骤"><span>冷备的操作步骤</span></a></h3><h4 id="_1-备份数据目录" tabindex="-1"><a class="header-anchor" href="#_1-备份数据目录"><span>1. 备份数据目录</span></a></h4><p>为了确保数据的一致性，在进行备份之前需要停止 MinIO 服务。这样可以避免在备份过程中出现数据不一致 的问题。</p><h5 id="停止-minio-服务" tabindex="-1"><a class="header-anchor" href="#停止-minio-服务"><span>停止 MinIO 服务</span></a></h5><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token function">sudo</span> systemctl stop minio</span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h5 id="复制数据目录" tabindex="-1"><a class="header-anchor" href="#复制数据目录"><span>复制数据目录</span></a></h5><p>使用 <code>rsync</code> 或 <code>scp</code> 工具将数据目录复制到异地节点。</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token comment"># 使用 rsync 进行备份</span></span>\n<span class="line"><span class="token function">rsync</span> <span class="token parameter variable">-avz</span> /path/to/minio/data/ user@remote-server:/path/to/backup/</span>\n<span class="line"></span>\n<span class="line"><span class="token comment"># 或者使用 scp 进行备份</span></span>\n<span class="line"><span class="token function">scp</span> <span class="token parameter variable">-r</span> /path/to/minio/data/ user@remote-server:/path/to/backup/</span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="启动-minio-服务" tabindex="-1"><a class="header-anchor" href="#启动-minio-服务"><span>启动 MinIO 服务</span></a></h5><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token function">sudo</span> systemctl start minio</span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_2-恢复数据目录" tabindex="-1"><a class="header-anchor" href="#_2-恢复数据目录"><span>2. 恢复数据目录</span></a></h4><p>当需要恢复数据时，可以将备份的数据目录复制到目标节点，然后启动 MinIO 服务。</p><h5 id="停止-minio-服务-1" tabindex="-1"><a class="header-anchor" href="#停止-minio-服务-1"><span>停止 MinIO 服务</span></a></h5><p>在目标节点上停止 MinIO 服务。</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token function">sudo</span> systemctl stop minio</span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h5 id="恢复数据目录" tabindex="-1"><a class="header-anchor" href="#恢复数据目录"><span>恢复数据目录</span></a></h5><p>使用 <code>rsync</code> 或 <code>scp</code> 工具将备份的数据目录复制到目标节点。</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token comment"># 使用 rsync 进行恢复</span></span>\n<span class="line"><span class="token function">rsync</span> <span class="token parameter variable">-avz</span> user@remote-server:/path/to/backup/ /path/to/minio/data/</span>\n<span class="line"></span>\n<span class="line"><span class="token comment"># 或者使用 scp 进行恢复</span></span>\n<span class="line"><span class="token function">scp</span> <span class="token parameter variable">-r</span> user@remote-server:/path/to/backup/ /path/to/minio/data/</span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="启动-minio-服务-1" tabindex="-1"><a class="header-anchor" href="#启动-minio-服务-1"><span>启动 MinIO 服务</span></a></h5><p>在目标节点上启动 MinIO 服务。</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token function">sudo</span> systemctl start minio</span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="确保数据一致性" tabindex="-1"><a class="header-anchor" href="#确保数据一致性"><span>确保数据一致性</span></a></h3><p>为了确保数据的一致性，可以使用文件系统快照技术进行冷备。例如，如果使用 LVM 管理存储，可以在备份 时创建一个 LVM 快照。</p><h5 id="创建-lvm-快照" tabindex="-1"><a class="header-anchor" href="#创建-lvm-快照"><span>创建 LVM 快照</span></a></h5><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line">lvcreate <span class="token parameter variable">--size</span> 10G <span class="token parameter variable">--snapshot</span> <span class="token parameter variable">--name</span> minio_snapshot /dev/vg0/minio_lv</span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h5 id="挂载快照并备份" tabindex="-1"><a class="header-anchor" href="#挂载快照并备份"><span>挂载快照并备份</span></a></h5><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token function">mkdir</span> /mnt/minio_snapshot</span>\n<span class="line"><span class="token function">mount</span> /dev/vg0/minio_snapshot /mnt/minio_snapshot</span>\n<span class="line"></span>\n<span class="line"><span class="token comment"># 使用 rsync 或 scp 备份快照</span></span>\n<span class="line"><span class="token function">rsync</span> <span class="token parameter variable">-avz</span> /mnt/minio_snapshot/ user@remote-server:/path/to/backup/</span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="卸载并删除快照" tabindex="-1"><a class="header-anchor" href="#卸载并删除快照"><span>卸载并删除快照</span></a></h5><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line"><span class="token function">umount</span> /mnt/minio_snapshot</span>\n<span class="line">lvremove /dev/vg0/minio_snapshot</span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="冷备的优缺点" tabindex="-1"><a class="header-anchor" href="#冷备的优缺点"><span>冷备的优缺点</span></a></h3><h4 id="优点" tabindex="-1"><a class="header-anchor" href="#优点"><span>优点</span></a></h4><ol><li><strong>简单易用</strong>：直接复制数据目录，操作相对简单。</li><li><strong>无需特殊工具</strong>：使用常见的文件复制工具即可完成备份和恢复。</li></ol><h4 id="缺点" tabindex="-1"><a class="header-anchor" href="#缺点"><span>缺点</span></a></h4><ol><li><strong>需要停机时间</strong>：为了确保数据一致性，需要停止 MinIO 服务。</li><li><strong>速度较慢</strong>：对于大量数据，文件系统级别的复制可能比较慢。</li><li><strong>占用存储空间</strong>：冷备的备份文件可能占用大量存储空间。</li></ol><h3 id="总结" tabindex="-1"><a class="header-anchor" href="#总结"><span>总结</span></a></h3><p>MinIO 的数据备份可以通过冷备的方式实现，即直接复制磁盘存储目录到异地节点。虽然这种方法简单易用， 但需要在备份和恢复过程中停止 MinIO 服务以确保数据一致性。在实际操作中，可以结合文件系统快照技术 来减少停机时间。冷备适用于对备份速度要求不高的场景，但在大规模数据备份时，可能需要考虑使用更高效 的备份和恢复方法。</p>',38)],l={},t=(0,n(6262).A)(l,[["render",function(a,s){return(0,e.uX)(),(0,e.CE)("div",null,i)}]]),r=JSON.parse('{"path":"/blog/minio/Minio-%E9%9B%86%E7%BE%A4%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8C%E5%86%B7%E5%A4%87.html","title":"Minio 集群数据备份如何进行冷备？","lang":"zh-CN","frontmatter":{"date":"2021-07-07T00:00:00.000Z","category":["Minio"],"tag":["对象存储"],"sticky":true,"excerpt":"<p> Minio 上传请求负载分析 </p>"},"headers":[{"level":3,"title":"冷备的操作步骤","slug":"冷备的操作步骤","link":"#冷备的操作步骤","children":[]},{"level":3,"title":"确保数据一致性","slug":"确保数据一致性","link":"#确保数据一致性","children":[]},{"level":3,"title":"冷备的优缺点","slug":"冷备的优缺点","link":"#冷备的优缺点","children":[]},{"level":3,"title":"总结","slug":"总结","link":"#总结","children":[]}],"git":{"updatedTime":1720536662000,"contributors":[{"name":"asus","email":"939943844@qq.com","commits":1}]},"filePathRelative":"blog/minio/Minio-集群数据备份如何进行冷备.md"}')}}]);